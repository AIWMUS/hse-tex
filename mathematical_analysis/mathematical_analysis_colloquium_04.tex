\documentclass[a4paper]{article}
\usepackage{header}
\usepackage{float}
\usepackage{cmap}

\newcommand\enumtocitem[3]{\item\textbf{#1}\addtocounter{#2}{1}\addcontentsline{toc}{#2}{\protect{\numberline{#3}} #1}}
\newcommand\defitem[1]{\enumtocitem{#1}{subsection}{\thesubsection}}
\newcommand\proofitem[1]{\enumtocitem{#1}{subsection}{\thesubsection}}

\newtheorem{theorem1*}{Theorem}

\newtheoremstyle{named}{}{}{}{}{\bfseries}{}{.5em}{Теорема \thmnote{#3}}
\theoremstyle{named}
\newtheorem*{namedtheorem}{Theorem}

\newcommand{\italicbold}[1]{\emph{\textbf{#1}}}

\newlist{colloq}{enumerate}{1}
\setlist[colloq]{label=\textbf{\arabic*.}}

\everymath{\displaystyle}

\title{\HugeМатематический анализ, Коллоквиум 4}
\author{
	Балюк Игорь \\
	\href{https://teleg.run/lodthe}{@lodthe},
    \href{https://github.com/LoDThe/hse-tex}{GitHub} \\
    Материалы предоставил Егор Косов.
}

\usepackage[yyyymmdd,hhmmss]{datetime}
\settimeformat{xxivtime}
\renewcommand{\dateseparator}{.}
\date{Дата изменения: \today \ в \currenttime}

\begin{document}
    \maketitle

    \tableofcontents

    \newpage

    Исходный код предоставил Егор Косов. В данном файле я попытался исправить опечатки и облегчить некоторые моменты для понимания.

    \href{https://www.youtube.com/watch?v=dQw4w9WgXcQ}{Оригинальный список вопросов}

    \section{Метрические и нормированные пространства.}

    \href{https://www.dropbox.com/s/donysz87em9jfhs/%D0%9B%D0%B5%D0%BA%D1%86%D0%B8%D1%8F%208.pdf?dl=0}{Оригинальный конспект.}

    \begin{definition*}
        Пусть $X$ --- множество. Функция $d: X \times X \to [0; +\infty)$ называется метрикой, если
        \begin{enumerate}
        \item $d(x, y) = 0 \iff x = y$;
        \item $d(x, y) = d(y, x) \forall x, y \in X$;
        \item $\norm{\lambda x} = |\lambda| \norm{x}, \forall x \in X$;
        \item $\norm{x + y} \leq \norm{x} + \norm{y} \forall x, y \in X$.
        \end{enumerate}

        Пара $(X, \norm{\cdot})$ называется нормированным пространством.
    \end{definition*}

    Нормой является привычнам нам длина вектора. Аналогично матрике, мы будем часто работать с Евклидовой нормой: пусть $x \in \RR^n$, тогда $\norm{x} = \sqrt{x_1^2 + \dots + x_n^2}$.

    Всякое нормированное пространство является метрическим с метрикой $d(x, y) = \norm{x - y}$.

    \begin{definition*}
        Пусть $X$ --- линейное пространство. Функция $\langle \cdot, \cdot \rangle: X \times X \to \RR$ называется скалярным произведением, если для всех $x, y, z \in X$ и всех $a, b \in \RR$ выполнены следующие условия:
        \begin{enumerate}
        \item $\langle x, x \rangle \geq 0$ и $\langle x, x \rangle = 0 \iff x = 0$;
        \item $\langle x, y \rangle = \langle y, x \rangle$;
        \item $\langle ax + by, z \rangle = a \langle x, z \rangle + b \langle y, z \rangle$.
        \end{enumerate}

        Линейное пространство $X$ со скалярным произведением называется Евклидовым.
    \end{definition*}

    Мы будем часто работать со следующим скалярным произведением: пусть $x, y \in \RR^n$, тогда $\langle x, y \rangle = x_1 \cdot y_1 \dots x_n \cdot y_n$.

    \begin{lemma*} (Неравенство Коши-Буняковского) 
        Пусть $\langle \cdot, \cdot \rangle$ скалярное произведение на линейном пространстве $X$, тогда $\forall x, y \in X$
        \begin{equation*}
            |\langle x, y \rangle| \leq \sqrt{\langle x, x \rangle} \cdot \sqrt{\langle y, y \rangle}.
        \end{equation*}
    \end{lemma*}

    \begin{proof}
        Заметим, что для $\lambda \in \RR$ выполнено
        \begin{equation*}
            0 \leq \langle x + \lambda y, x + \lambda y \rangle = \lambda^2 \langle y, y \rangle + 2\lambda \langle x, y \rangle + \rangle x, x \rangle.
        \end{equation*}

        Не ограничивая общности, считаем, что $\langle y, y \rangle > 0$ (иначе $y$ --- нулевой вектор, доказательство тривиально). Это означает, что ветви параболы смотрят вверх. Но парабола не касается оси $Ox$, поэтому дискриминант этого трехчлена неположителен, т.е. $4|\langle x, y \rangle| - 4\langle y, y \rangle \langle x, x \rangle \leq 0$.
    \end{proof}

    \begin{consequence*}
        На евклидовом пространстве функция $\norm{x} := \sqrt{\langle x, x \rangle}$ является нормой.
    \end{consequence*}

    \begin{proof}
        Первые два свойства следуют из определения скалярного произведения. Неравенство треугольника следует из неравенства Коши-Буняковского:
        \begin{equation*}
            \norm{x + y}^2 = \langle x + y, x + y \rangle \leq \norm{x}^2 + 2 \cdot |\langle x, y \rangle| + \norm{y}^2 \leq \norm{x}^2 + 2\norm{x}\norm{y} + \norm{y}^2 = (\norm{x} + \norm{y})^2.
        \end{equation*}
    \end{proof}

    \begin{example*}
        На линейном пространстве $\RR^k$ всех упорядоченных наборов $(x_1, \dots, x_k)$ задано скалярное произведение $\langle x, y \rangle := \sum_{j = 1}^k x_jy_j$. Тем самым, на $\RR^k$ задана естественная евклидова метрика $\norm{x - y} := \sqrt{|x_1 - y_1|^2 + \dots + |x_k - y_k|^2}$.
    \end{example*}

    \begin{definition*}
        Пусть $(X, d)$ метрическое пространство.
        \begin{enumerate}
        \item
            Множество 
            \begin{equation*}
                B_r(x_0) := \{x \in X \mid d(x, x_0) < r\}
            \end{equation*}
            называется \textbf{открытым шаром} радиуса $r$.

        \item
            Множество
            \begin{equation*}
                \overline{B_r}(x_0) := \{x \in X \mid d(x, x_0) \leq r\}
            \end{equation*}
            называется \textbf{замкнутым шаром} радиуса $r$.

        \item
            Последовательность точек $x_n \in X$ называется \textbf{сходящейся к точке $x$}, если для всякого $\eps > 0$ найдется такой номер $N(\eps)$, что $d(x, x_n) < \eps$ для каждого $n \geq N(\eps)$.

        \item
            Последовательность точек $x_n \in X$ называется \textbf{фундаментальной}, если для всякого $\eps > 0$ найдется такой номер $N(\eps)$, что $d(x_k, x_n) < \eps$ для всех $k, n \geq N(\eps)$.

        \item
            Точка $x$ называется \textbf{предельной} для множества $M \subset X$, если для всякого $\eps > 0$ выполнено $B_{\eps}(x) \cap (M \setminus \{x\}) \neq \varnothing$.

        \item
            Множество $U \subset X$ называется \textbf{открытым}, если для всякого $x \in U$ найдется такое $\eps > 0$, что $B_{\eps}(x) \subset U$.

        \item
            Множество $F \subset X$ называется \textbf{замкнутым}, если множество $X \setminus F$ открыто.
        \end{enumerate}
    \end{definition*}   

    \begin{lemma*}
        Пусть $(X, d)$ метрическое пространство. Тогда
        \begin{enumerate}
        \item
            если $x_n \to x, y_n \to y$, то $d(x_n, y_n) \to d(x, y)$;

        \item
            предел сходящейся последовательности единственный;

        \item
            любой открытый шар является открытым множеством;

        \item
            множество $F$ замкнуто тогда и только тогда, когда множество $F$ содержит все свои предельные точки.
        \end{enumerate}

        \begin{proof}
            ~

            \begin{enumerate}
            \item
                Следует из оценки
                \begin{equation*}
                    |d(x_n, y_n) - d(x, y)| \leq |d(x_n, y_n) - d(x_n, y)| + |d(x_n, y) - d(x, y)| \leq d(y_n, y) + d(x_n, x).
                \end{equation*}

            \item
                Следует из пункта $1)$.

            \item
                Если $x \in B_r(x_0)$, то по неравенству треугольника $B_{\eps}(x) \subset B_r(x_0)$ при $\eps + d(x, x_0) < r$.

            \item
                Множество $F$ замкнуто тогда и только тогда, когда $\forall x \notin F \ \exists \eps > 0: \ B_{\eps} \cap F = \varnothing \iff$ всякая точка $x \notin F$ --- не предельная для $F$.
            \end{enumerate}
        \end{proof}
    \end{lemma*}

    \begin{definition*}
        Метрическое пространство называется полным, если каждая фундаментальная последовательность в нем сходится.
    \end{definition*}

    \begin{remark*}
        На $\RR^k$ справедливы соотношения
        \begin{equation*}
            \max\limits_{1 \leq j \leq k} |x_j| \leq \norm{x_j} \leq \sqrt{k} \cdot \max\limits_{1 \leq j \leq k} |x_j|
        \end{equation*}
        для векторов $x = (x_1, \dots, x_k)$. Тем самым, последовательность $x_n \to x$ в $\RR^k$ тогда и только тогда, когда $(x_n)_j \to x_j$.
    \end{remark*}

    \begin{example*}
        Пространство $\RR^k$ со стандартной евклидовой метрикой полное. Действительно. если последовательность векторов $x_n \in \RR^k$ фундаментальна, то фундаментальны и последовательности координат $\{(x_n)_j\}_{j = 1}^{\infty}$ для всякого $j \in \{1, \dots, k\}$.

        Тем самым, у $j$-ой координаты есть предел $x_j$ для каждого $j \in \{1, \dots, k\}$. То есть $|(x_n)_j - x_j| \to 0$. Значит, $x_n \to x := (x_1, \dots, x_k)$.
    \end{example*}

    \begin{example*}
        Пусть $X = [0; \pi / 2)$. Пространство $X$ не является полным с метрикой $d_1(x, y) = |x - y|$, но является полным с метрикой $d_2(x, y) = |\tg x - \tg y|$.
    \end{example*}

    \begin{definition*}
        Пусть $(X, d_X)$ и $(Y, d_Y)$ --- два метрических пространства. Отображение $f: X \to Y$ называется непрерывным в точке $x_0 \in X$, если для всякой последовательности $x_n \to x_0$ выполнено $f(x_n) \to f(x_0)$.
    \end{definition*}

    \begin{lemma*}
        Пусть $(X, d_X)$ и $(Y, d_Y)$ --- два метрических пространства.
        \begin{enumerate}
        \item
            Отображение $f: X \to Y$ является непрерывным в точке $x \in X$ тогда и только тогда, когда для всякого $\eps > 0$ найдется $\delta > 0$ такое, что $d_Y(f(x), f(x_0)) < \eps$, если $d_X(x, x_0) < \delta$.

        \item
            Отображение $f: X \to Y$ является непрерывным в каждой точке $x \in X$ тогда и только тогда, когда прообраз каждого открытого множества в $Y$ будет открытым множеством в $X$ (такие отображения будем называть просто непрерывными).
        \end{enumerate}
    \end{lemma*}

    \begin{proof}
        ~

        \begin{enumerate}
        \item
            Отображение $f$ разрывно в точке $x_0$ $\iff$ найдется последовательность $x_n \to x_0$, для которой $f(x_n)$ не сходится к $f(x_0)$ $\iff$ найдется число $\eps > 0$ и последовательность $x_n' \to x_0$, для которой $d_Y(f(x_n'), f(x_0)) \geq \eps$ $\iff$ найдется такое число $\eps > 0$, что для произвольного $\delta > 0$ существует $x_{\delta} \in B_{\delta}(x_0)$, для которого $d_Y(f(x_\delta), f(x_0)) \geq \eps$.

        \item
            Если прообраз любого открытого множества открыт, то для произвольного $\eps > 0$ найдется такое $\delta > 0$, что $f^{-1}(B_{\eps}(f(x_0))) \supset B_{\delta}(x_0)$, и значит отображение $f$ непрерывно в точке $x_0$. Наоборот: пусть $U$ --- открыто в $Y$ и $x_0 \in f^{-1}(U)$. Тогда в силу открытости найдется $\eps > 0$, для которого $B_{\eps}(f(x_0)) \subset U$. Из-за непрерывности в точке $x_0$ найдется такое $\delta > 0$, что $f^{-1}(B_{\eps}(f(x_0))) \supset B_{\delta}(x_0)$, что дает открытость множества $f^{-1}(U)$.
        \end{enumerate} 
    \end{proof}

    \begin{proposal*}
        Пусть $f: X \to Y$ непрерывна в точке $a \in X$, $g: Y \to Z$ непрерывна в точке $f(a) \in Y$. Тогда композиция $g \circ f: X \to Z$ непрерывна в точке $a$.
    \end{proposal*}

    \begin{proof}
        Следует из определения непрерывности. TODO()
    \end{proof}

    \begin{consequence*}
        Пусть $f, g: \RR^k \to \RR^m$ --- непрерывные в точке $a$ функции. Тогда $f + g$ и $f \cdot g$ --- непрерывны в точке $a$.
    \end{consequence*}

    \begin{proof}
        Следует из того, что отображение $(x_1, x_2) \to x_1 + x_2$ и $(x_1, x_2) \to x_1 \cdot x_2$ непрерывны на $\RR^2$.
    \end{proof}

    \begin{definition*}
        Пусть $(X, d_X)$ и $(Y, d_Y)$ --- метрические пространства и пусть $x_0$ --- предельная точка в $X$. Скажем, что предел функции $f: X \to Y$ в точке $x_0$ равен $y_0$, если функция $g$, определенная соотношением $g(x) = f(x)$ при $x \neq x_0$ и $g(x_0) = y_0$ иначе, непрерывна в точке $x_0$.
    \end{definition*}
        
    \section{Компакты в метрических пространствах}

    \begin{definition*}
        Множество $K$ в метрическом пространстве называется компактным тогда и только тогда, когда из произвольной последовательности $\{x_n\}_{n = 1}^{\infty} \subset K$ можно выделить сходящуюся подпоследовательность $x_{n_k} \to x \in K$.
    \end{definition*}

    \begin{lemma*}
        Пусть $K$ --- компакт. Тогда
        \begin{enumerate}
        \item
            $K$ --- ограниченное множество;

        \item
            $K$ --- замкнутое множество;

        \item
            образ $K$ при непрерывном отображении компактен.
        \end{enumerate}
    \end{lemma*}

    \begin{proof}
        ~

        \begin{enumerate}
        \item
            Зафиксируем произвольную точку $x_0 \in K$. Если $K$ --- неограниченное множество, то найдется последовательность $x_n \in K$, $d(x_n, x_0) \to \infty$. Переходя к подпоследовательности, имеем $x_{n_k} \to x$, $d(x_{n_k}, x_0) \to d(x, x_0)$. Противоречие.

        \item
            Если $x_n \in K$, $x_n \to x_0$, то переходя к подпоследовательности $x_{n_k} \to x \in K$, в силу единственности предела $x_0 = x \in K$.

        \item
            Рассмотрим последовательность $\{f(x_n)\}_{n = 1}^{\infty}$, $x_n \in K$. Переходя к подпоследовательности имеем $x_{n_k} \to x \in K$. Так как $f$ --- непрерывное отображение, то $f(x_{n_k}) \to f(x) \in f(K)$.
        \end{enumerate}
    \end{proof}

    \begin{proposal*}
        Множество $K$ в $\RR^k$ со стандартной евклидовой метрикой компактно тогда и только тогда, когда оно замкнуто и ограничено.
    \end{proposal*}

    \begin{proof}
        Необходимость этого условия следует из предыдущей леммы. Проверим достаточность. Пусть множество $K$ --- замкнуто и ограничено, и пусть $x_n \in K$. В силу ограниченности $K$ ограниченными будут и все координаты $(x_n)_j$ последовательности $x_n$. Тогда найдется сходящаяся подпоследовательность первых координат $(x_{n_m})_1$. Далее, из последовательности $(x_{n_m})_2$ можно также извлечь сходящуюся подпоследовательность. Повторяя процедуру, получим подпоследовательность $x_n'$, у которой каждая координата сходится, то есть $(x_n')_j \to x_j$ для некоторого $x_j$. Тем самым, $x_n' \to x = (x_1, \dots, x_k)$. В силу замкнутости $K$, вектор $x \in K$.
    \end{proof}

    \begin{consequence*}
        Пусть $K$ --- компакт, $f: K \to \RR$ --- непрерывная функция. Тогда образ $f(K)$ --- ограниченное множество и найдутся точки $x_m, x_M \in K$, для которых $f(x_m) = \inf\limits_{x \in K} f(x), f(x_M) = \sup\limits_{x \in K} f(x)$.
    \end{consequence*}

    \section{Дифференцируемость отображений}

    \begin{definition*}
        Отображение $f: \RR^k \to \RR^m$ называется дифференцируемым в точке $x$, если для каждого $h \in \RR^k$
        \begin{equation*}
            f(x + h) = f(x) + Lh + \alpha(h) \norm{h},
        \end{equation*}
        где $L: \RR^k \to \RR^m$ --- линейное отображение, $\lim_{\norm{h} \to 0} \norm{\alpha(h)} = 0$. Линейное отображение $L$ называют дифференциалом $f$ в точке $x$ и обозначают $\dd f$.
    \end{definition*}

    \begin{remark*}
        Напомним, что отображение $L: \RR^k \to \RR^m$ называется линейным, если
        \begin{equation*}
            L(a_1h_1 + a_2h_2) = a_1Lh_1 + a_2Lh_2
        \end{equation*}
        для произвольных векторов $h_1, h_2, \in \RR^k$ и произвольных чисел $a_1, a_2 \in \RR$. 
        
        Если в $\RR^k$ фиксирован базис $e := \{e_1, \dots, e_k\}$, а в $\RR^m$ фиксирован $e' := \{e_1', \dots, e_m'\}$, то линейное отображение $L$ представимо в виде $L(h) = L(e_1)h_1 + \dots + L(e_k)h_k$, где $h = (h_1, \dots, h_k)$ в базисе $e$, а векторы $L(e_j) = (e_{1,j}, \dots, a_{m, j})$ в базисе $e'$. 

        В частности, каждое линейное отображение при фиксированных базисах $e$ и $e'$ в $\RR^k$ и $\RR^m$ соответственно записывается с помощью матрицы $A = (a_{ij})$. Кроме того,
        \begin{equation*}
            \norm{Lh} \leq (\norm{L(e_1)} + \dots + \norm{L(e_k)}) \cdot \max\limits_{1 \leq j \leq k} |h_j| \leq C \norm{h}
        \end{equation*}
        и каждое линейное отображение непрерывно на $\RR^k$.
    \end{remark*}

    \begin{consequence*}
        Если отображение $f: \RR^k \to \RR^m$ дифференцируемо в точке $x$, то оно непрерывно в точке $x$.
    \end{consequence*}

    \begin{proof}
        Действительно, $\norm{f(x + h) - f(x)} = \norm{\dd f(h) + \alpha(h)\norm{h}} \leq C\norm{h}$ при $h$ из некоторой окрестности нуля.
    \end{proof}

    \begin{remark*}
        Так как дифференцируемость $f$ в точке $x$ равносильна тому, что
        \begin{equation*}
            \lim_{h \to 0} \dfrac{\norm{f(x + h) - f(x) - Lh}}{\norm{h}} = 0,
        \end{equation*}
        и так как сходимость по норме равносильна покоординатной сходимости, то при фиксирвоанном базисе $e' := \{e_1', \dots, e_m'\}$ в $\RR^m$ дифференцируемость отображения $f$ равносильна дифференцируемости каждой координаты $f_j$ в точке $x$. В этом случае $Lh = (L_1h, \dots, L_mh)$ в базисе $e'$, где $L_j = \dd f_j$ --- дифференциал $j$-ой координаты.
    \end{remark*}

    \begin{lemma*}
        Если отображение $f: \RR^k \to \RR^m$ дифференцируемо в точке $x$, то для каждого вектора $h \in \RR^k$ функция $t \to f(x + th)$ дифференцируема в точке $0$ и $\left.\dfrac{\dd}{\dd t}f(x + th)\right|_{t = 0} = \dd f(h)$.
    \end{lemma*}

    \begin{proof}
        По определению 
        \begin{equation*}
            f(x + th) - f(x) = t \dd f(h) + t \alpha(th)\norm{h}.
        \end{equation*}

        Разделив на $t$ и перейдя к пределу при $t \to 0$, получаем требуемое соотношение.
    \end{proof}

    \begin{definition*}
        Производная $\dfrac{\partial f}{\partial h}(x) := \left.\dfrac{\dd}{\dd t}f(x + th)\right|_{t = 0}$ называется производной вдоль вектора $h$ и может существовать и в случае, когда сама функция $f$ не дифференцируема в точке $x$.
    \end{definition*}

    Как мы уже поняли, для дифференцируемости отображения достаточно исследовать дифференцируемость его координат, то есть дифференцируемость функции $f: \RR^k \to \RR$. Зафиксировав базис $e := \{e_1, \dots, e_k\}$ в $\RR^n$, условие дифференцируемости в точке $x = (x_1, \dots, x_k)$ переписывается в виде
    \begin{equation*}
        f(x_1 + h_1, \dots, x_k + h_k) f(x_1, \dots, x_k) + c_1h_1 + \dots + c_k h_k + \os(\norm{h}),
    \end{equation*}
    то есть $\dd f(h) = c_1h_1 + \dots + c_kh_k$. Из уже доказанного ясно, что $\dfrac{\partial f}{\partial e_j}(x) = \dd f(e_j) = c_j$.

    \begin{definition*}
        Частной производной $\dfrac{\partial f}{\partial x_j}$ функции $f: \RR^k \to \RR$ в точке $x = (x_1, \dots, x_k)$ называется производная вдоль вектора $e_j$, то есть
        \begin{equation*}
            \dfrac{\partial f}{\partial x_j}(x) = \left.\dfrac{\dd}{\dd t}f(x_1, \dots, x_{j - 1}, t, x_{j + 1}, \dots, x_k)\right|_{t = x_j}.
        \end{equation*}
    \end{definition*}

    \begin{remark*}
        При фиксированно базисе $e = \{e_1, \dots, e_k\}$ в $\RR^k$ линейные функционалы $\dd x_1, \dots, \dd x_k$ оказываются сопряженным базисом к $e$. То есть $\dd x_i(e_j) = \delta_{i, j}$. Таким образом, $\dd f = \dfrac{\partial f}{\partial x_1}\dd x_1 + \dots + \dfrac{\partial f}{\partial x_k}\dd x_k$.
    \end{remark*}

    \begin{remark*}
        В случае отображения $f: \RR^k \to \RR^m$ при фиксированных базисах $e$ и $e'$ в $\RR^k$ и в $\RR^m$ соответственно, компоненты матрицы дифференциала $\dd f$ имеют вид $a_{i, j} = \dfrac{\partial f_i}{\partial x_j}(x)$, то есть по строкам написаны градиенты $\nabla f_i(x)$.
    \end{remark*}

    \begin{definition*}
        При фиксированных базисах $e$ в $\RR^k$ и $e'$ в $\RR^m$ матрицу, соответствующую линейному отображению $\dd f$, называют матрицей Якоби отображения $f$ в точке $x$ и обозначают $J_f(x)$.
    \end{definition*}

    \section{Градиент и достаточное условие дифференцируемости}

    \begin{definition*}
        {\it Градиентом} функции $f$ называется вектор
        $\nabla f:=\left(\dfrac{\partial f}{\partial x_1},\ldots,\dfrac{\partial f}{\partial x_n}\right)$.
    \end{definition*}

    \begin{lemma*}
        Если $f$ дифференцируема в точке $x$ и $\dd f\ne0$, то наибольшее значение производной вдоль единичного вектора
        $v$ (т.е. $\|v\|=1$) достигается на векторе $\|\nabla f(x)\|^{-1}\nabla f(x)$.
    \end{lemma*}

    \begin{proof}
        Так как $\dfrac{\partial f}{\partial v}(x) = \dd f(v) = \langle\nabla f(x), v\rangle$,
        то по неравенства Коши--Буняковского $\Bigl|\dfrac{\partial f}{\partial v}(x)\Bigr|\leq \|\nabla f(x)\|\|v\|
        =\|\nabla f(x)\|$. Если $v=\|\nabla f(x)\|^{-1}\nabla f(x)$, то в неравенстве достигается равенство.
    \end{proof}

    Заметим, что наличия частных производных в точке недостаточно для дифференцируемости функции в этой точке.

    \begin{example*}
        Пусть
        $$
            f(x,y)=
            \left\{
            \begin{aligned}
                \dfrac{2xy}{x^2+y^2}, &\ (x,y)\ne(0,0), \\
                0, &\ (x,y)=(0,0).\\
            \end{aligned}
            \right.
        $$
        Функция $f$ разрывна в нуле, а значит не дифференцируема, но в точке $(0,0)$ существуют обе частных производных.
        Действительно, если $x=r\cos\varphi, y=r\sin\varphi$, то функция $f(x,y) = \sin2\varphi$. Таким образом, $f(x,y)$ в любой окрестности точки $(0,0)$ принимет значения $\pm1$, но $\dfrac{\partial f}{\partial x}(0,0) = \dfrac{d}{dx}f(x,0) = 0$.
        Аналогично $\dfrac{\partial f}{\partial y}(0,0)=0$.
    \end{example*}


    В следующей теореме сформулировано достаточное условие дифференцируемости.

    \begin{theorem*}
        Если все частные производные $\dfrac{\partial f}{\partial x_j}$ существуют в окрестности точки $x_0$ и непрерывны в этой точке, то $f$ --- дифференцируема в точке $x_0$.
    \end{theorem*}

    \begin{proof}
        Для сокращения выкладок докажем теорему в случае $k=2$.
        Заметим, что
        \begin{align*}
            f(x_1+h_1,x_2+h_2) - f(x_1,x_2)
            &=f(x_1+h_1,x_2+h_2) - f(x_1,x_2+h_2) + f(x_1, x_2+h_2) - f(x_1,x_2) \\
            &=\dfrac{\partial f}{\partial x_1}(\xi_1, x_2+h_2)h_1 + \dfrac{\partial f}{\partial x_2}(x_1,\xi_2)h_2,
        \end{align*}

        где $\xi_1$ принадлежит интервалу с концами
        $x_1$, $x_1+h_1$, а $\xi_2$ --- с концами $x_2$, $x_2+h_2$.
        Запишем теперь последнюю сумму в виде
        $$
            \dfrac{\partial f}{\partial x_1}(x_1, x_2)h_1 + \dfrac{\partial f}{\partial x_2}(x_1,x_2)h_2 + \alpha(h)\|h\|,
        $$
        где
        $$
            \alpha(h) =
            \Bigl(\dfrac{\partial f}{\partial x_1}(\xi_1, x_2+h_2) - \dfrac{\partial f}{\partial x_1}(x_1, x_2)\Bigr)\dfrac{h_1}{\|h\|}
            +
            \Bigl(\dfrac{\partial f}{\partial x_2}(x_1,\xi_2) - \dfrac{\partial f}{\partial x_2}(x_1, x_2)\Bigr)\dfrac{h_2}{\|h\|}.
        $$
        При малой $\|h\|$ выражения в скобках будут малы в силу непрерывности частных производных.
        Тем самым, $\lim\limits_{h\to 0}\|\alpha(h)\| = 0$.
    \end{proof}

    \section{Частные производные высокого порядка}

    \begin{definition*}
        Пусть $f\colon \RR^k\to \RR$ и предположим, что в некоторой окрестности $B_r(x_0)$ точки $x_0$ существует частная производная $\dfrac{\partial f}{\partial x_j}$. Если функция $x\mapsto \dfrac{\partial f}{\partial x_j}(x)$ в точке $x_0$ имеет частную производную по переменной $x_i$, то эта частная производная $\dfrac{\partial}{\partial x_i}\Bigl(\dfrac{\partial f}{\partial x_j}\Bigr) (x_0)$ называется {\it частной производной второго порядка} по переменным $x_j$ и $x_i$
        и обозначается $\dfrac{\partial^2 f}{\partial x_i\partial x_j}(x_0)$.
    \end{definition*}

    \begin{remark*}
        Заметим, что частные производные $\dfrac{\partial^2 f}{\partial x_i\partial x_j}$ и $\dfrac{\partial^2 f}{\partial x_j\partial x_i}$ являются разными объектами и, вообще говоря, не совпадают (пример будет в рамках семинарских задач).
    \end{remark*}

    О совпадении смешанных частных производных позволяют судить следующие две теоремы, которые мы для простоты сформулируем в двумерном случае (общий случай, по сути, ничем не отличается).

    \begin{theorem}[Шварц]
        Пусть смешанные частные производные $\dfrac{\partial^2f}{\partial x\partial y}$ и $\dfrac{\partial^2f}{\partial y\partial x}$ существуют в окрестности точки $(x_0,y_0)$ и непрерывны в этой точке. Тогда их значения в точке $(x_0,y_0)$ совпадают.
    \end{theorem}

    \begin{theorem}[Юнг] Пусть $f$ --- дифференцируема в окрестности точки $(x_0,y_0)$,
    а ее частные производные $\dfrac{\partial f}{\partial x}$ и $\dfrac{\partial f}{\partial y}$
    дифференцируемы в точке $(x_0,y_0)$.
    Тогда смешанные частные производные $\dfrac{\partial^2f}{\partial x\partial y}$
    и $\dfrac{\partial^2f}{\partial y\partial x}$
    в точке $(x_0,y_0)$ совпадают.
    \end{theorem}

    Приведем доказательство второй из этих теорем.

    \begin{proof}
        Не ограничивая общности, будм считать, что $(x_0,y_0)=(0,0)$.
        Рассмотрим функцию
        $$
        F(t,t) = f(t,t) - f(0,t) - f(t,0) + f(0,0).
        $$
        Применяя теорему Лагранжа к функции $g(u)= f(t,u)-f(0,u)$,
        получаем
        $$
        F(t,t) = g(t) - g(0) = g'(\xi)t = \Bigl(\dfrac{\partial f}{\partial y}(t,\xi) -  \dfrac{\partial f}{\partial y}(0,\xi)\Bigr)t.
        $$
        Дифференцируемость $\dfrac{\partial f}{\partial y}$ в точке $(0,0)$ означает, что
        $$
        \dfrac{\partial f}{\partial y}(x,y) = \dfrac{\partial f}{\partial y}(0,0) +
        \dfrac{\partial^2 f}{\partial x\partial y}(0,0)x + \dfrac{\partial^2 f}{\partial y^2}(0,0)y + \os(\sqrt{x^2+y^2}).
        $$
        Таким образом,
        $$
        \dfrac{\partial f}{\partial y}(t,\xi) = \dfrac{\partial f}{\partial y}(0,0) +
        \dfrac{\partial^2 f}{\partial x\partial y}(0,0)t + \dfrac{\partial^2 f}{\partial y^2}(0,0)\xi + \os(\sqrt{t^2+\xi^2}).
        $$
        и
        $$
        \dfrac{\partial f}{\partial y}(0,\xi) = \dfrac{\partial f}{\partial y}(0,0) +
        \dfrac{\partial^2 f}{\partial y^2}(0,0)\xi + \os(\xi).
        $$
        Т.к. $\xi\leq t$, то $\os(\sqrt{t^2+\xi^2}) = \os(t)$ и $\os(\xi) = \os(t)$.
        Таким образом,
        $$
        F(t,t) = \dfrac{\partial^2 f}{\partial x\partial y}(0,0)t^2 + \os(t^2).
        $$
        Аналогично,
        $$
        F(t,t) = \dfrac{\partial^2 f}{\partial y\partial x}(0,0)t^2 + \os(t^2).
        $$
        Приравняв полученные выражения, поделив на $t^2$ и устремив $t$ к нулю, получаем
        $$
        \dfrac{\partial^2 f}{\partial x\partial y}(0,0) = \dfrac{\partial^2 f}{\partial y\partial x}(0,0).
        $$
    \end{proof}

    \section{Правила дифференцирования}

    \begin{theorem*}
        Пусть функции $f, g \colon \RR^k\to \RR$ дифференцируемы в некоторой точке $x$. Тогда, для произвольных чисел $a,b \in \RR$,
        функции $af + bg$ и $fg$ дифференцируемы в точке $x$ и $\dd(af + bg) = a\dd f + b\dd g$ и $d(fg) = f\dd g + g\dd f$.
    \end{theorem*}

    \begin{proof}
        Заметим, что
        \begin{multline*}
            (af+bg)(x+h) - (af + bg)(x) = a(f(x+h) - f(x)) + b(g(x+h) - g(x))\\
            = a(\dd f(h) + \os(\|h\|)) + b(\dd g (h) + \os(\|h\|))
            = a\dd f(h) + b\dd g(h) + \os(\|h\|).
        \end{multline*}
        Таким образом, $\dd(af + bg) = a\dd f +b\dd g$.

        Для доказательства второго равенства заметим, что
        \begin{align*}
            (fg)(x+h) - (fg)(x) 
            &= (f(x+h) - f(x))g(x+h) + f(x)(g(x+h) - g(x)) \\
            &= (\dd f(h) + \os(\|h\|))(g(x) +\os(1)) + f(x)(\dd g (h) + \os(\|h\|)) \\
            &= g(x)\dd f(h) + f(x)\dd g(h) + (\dd f(h))\os(1) + g(x)\os(\|h\|)+ f(x)\os(\|h\|) + \os(\|h\|).
        \end{align*}

        Мы использовали непрерывность функции $g$, т.е. $g(x+h)-g(x) = \os(1)$ при $\|h\| \to 0$,
        в силу ее дифференцируемости в точке $x$.

        Так как $\dd f$ --- линейное отображение, то для некоторого числа $C>0$ выполнено $|\dd f(h)|\leq C\|h\|$, а значит $(\dd f(h))\os(1) = \os(\|h\|)$.
        Т.к. $f(x)$ и $g(x)$ просто числа, то $ g(x)\os(\|h\|)+ f(x)\os(\|h\|) = \os(\|h\|)$.
        Таким образом, теорема доказана.
    \end{proof}
\end{document}